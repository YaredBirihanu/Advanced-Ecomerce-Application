{% extends "base.html" %}
{% load static %}

{% block content %}

<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-content padding-y" style="background: linear-gradient(to right, #f8f9fa, #e9ecef); min-height: 100vh;">

<!-- ============================ COMPONENT REGISTER   ================================= -->
    <div class="card mx-auto shadow-lg" style="max-width:520px; margin-top:40px; border-radius: 15px; border: none;">
      <article class="card-body p-5">
        <header class="mb-4 text-center">
            <img src="{% static 'images/logo.png' %}" alt="Logo" height="50" class="mb-3">
            <h4 class="card-title" style="color: #2c3e50; font-weight: 600;">Create Your Account</h4>
            <p class="text-muted">Join our community today</p>
        </header>
        
        <form action="{% url 'register' %}" method="POST" class="needs-validation" novalidate>
            {% csrf_token %}
            
            <!-- Success/Error Messages -->
            {% if messages %}
                {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                {% endfor %}
            {% endif %}
            
            <!-- Name Fields -->
            <div class="form-row">
                <div class="col form-group">
                    <label class="font-weight-bold">First name</label>
                    {{ form.first_name }}
                    <div class="invalid-feedback">Please enter your first name</div>
                </div>
                <div class="col form-group">
                    <label class="font-weight-bold">Last name</label>
                    {{ form.last_name }}
                    <div class="invalid-feedback">Please enter your last name</div>
                </div>
            </div>
            
            <!-- Contact Fields -->
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label class="font-weight-bold">Email Address</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                        </div>
                        {{ form.email }}
                    </div>
                    <small class="form-text text-muted">We'll never share your email with anyone else.</small>
                    <div class="invalid-feedback">Please provide a valid email</div>
                </div>
                <div class="form-group col-md-6">
                    <label class="font-weight-bold">Phone Number</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-phone"></i></span>
                        </div>
                        {{ form.phone_number }}
                    </div>
                    <div class="invalid-feedback">Please provide a valid phone number</div>
                </div>
            </div>
            
            <!-- Password Fields -->
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label class="font-weight-bold">Password</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-lock"></i></span>
                        </div>
                        {{ form.password }}
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary toggle-password" type="button">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    <div class="progress mt-2" style="height: 5px;">
                        <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                    </div>
                    <small class="form-text text-muted password-strength-text">Password strength: Weak</small>
                    <div class="invalid-feedback">Password must be at least 8 characters</div>
                </div>
                <div class="form-group col-md-6">
                    <label class="font-weight-bold">Confirm Password</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-lock"></i></span>
                        </div>
                        {{ form.confirm_password }}
                    </div>
                    <div class="invalid-feedback">Passwords must match</div>
                </div>
            </div>
            
            <!-- Terms Checkbox -->
            <div class="form-group">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="terms" required>
                    <label class="form-check-label" for="terms">
                        I agree to the <a href="#">Terms and Conditions</a>
                    </label>
                    <div class="invalid-feedback">You must agree before submitting</div>
                </div>
            </div>
            
            <!-- Submit Button -->
            <div class="form-group">
                <button type="submit" class="btn btn-primary btn-block py-2" 
                        style="background: linear-gradient(to right, #3498db, #2c3e50); border: none; border-radius: 25px; font-weight: 600;">
                    <i class="fas fa-user-plus mr-2"></i> Create Account
                </button>
            </div>
            
            <div class="text-center mb-3">
    <p class="text-muted">Or sign up with</p>
			<div>
				<a href="{{ google_oauth_url }}" class="btn btn-outline-primary mr-2">
					<i class="fab fa-google"></i> Google
				</a>
				<a href="{{ twitter_oauth_url }}" class="btn btn-outline-info mr-2">
					<i class="fab fa-twitter"></i> Twitter
				</a>
				<a href="{{ github_oauth_url }}" class="btn btn-outline-dark">
					<i class="fab fa-github"></i> GitHub
				</a>
			</div>
		</div>
        </form>
        
        <div class="text-center mt-3">
            <p class="text-muted">Already have an account? <a href="{% url 'login' %}" style="color: #3498db; font-weight: 500;">Sign In</a></p>
        </div>
      </article><!-- card-body.// -->
    </div> <!-- card .// -->
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->

<!-- Add this before the endblock -->
<script>
// Password toggle functionality
document.querySelectorAll('.toggle-password').forEach(function(button) {
    button.addEventListener('click', function() {
        const input = this.closest('.input-group').querySelector('input');
        const icon = this.querySelector('i');
        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            input.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    });
});

// Password strength indicator
document.querySelector('#id_password').addEventListener('input', function(e) {
    const strengthText = document.querySelector('.password-strength-text');
    const progressBar = document.querySelector('.progress-bar');
    const password = e.target.value;
    
    let strength = 0;
    if (password.length >= 8) strength += 1;
    if (password.match(/[a-z]/) && password.match(/[A-Z]/)) strength += 1;
    if (password.match(/[0-9]/)) strength += 1;
    if (password.match(/[^a-zA-Z0-9]/)) strength += 1;
    
    const strengthMap = {
        0: {width: '20%', color: 'danger', text: 'Very Weak'},
        1: {width: '40%', color: 'danger', text: 'Weak'},
        2: {width: '60%', color: 'warning', text: 'Moderate'},
        3: {width: '80%', color: 'info', text: 'Strong'},
        4: {width: '100%', color: 'success', text: 'Very Strong'}
    };
    
    progressBar.style.width = strengthMap[strength].width;
    progressBar.className = `progress-bar bg-${strengthMap[strength].color`;
    strengthText.textContent = `Password strength: ${strengthMap[strength].text}`;
});
</script>

{% endblock content %}